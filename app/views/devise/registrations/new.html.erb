<div class="container card">
  <div class="row">
    <div class="col-sm-4 col-sm-offset-4">
      <h2 class="font-custom">Créer votre compte</h2>

      <%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>
        <%= f.error_notification %>

        <div class="form-inputs">
           <%= f.input :pseudo,  input_html: { maxlength: 20} %>
          <%= f.input :email,
                      required: true,
                      autofocus: true,
                      input_html: { autocomplete: "email" }%>
          <%= f.input :password,
                      required: true,
                      hint: ("#{@minimum_password_length} characters minimum" if @minimum_password_length),
                      input_html: { autocomplete: "new-password" } %>
          <%= f.input :password_confirmation,
                      required: true,
                      input_html: { autocomplete: "new-password" } %>

          <div class="card">
          <%= link_to 'Voir la Politique de confidentialité', politique_path, class: 'm-3' %>
          <%= f.input :accepter,
                      required: true,
                      :as => :boolean,
                      input_html: {checked: false, id: 'checkbox'},
                      label: 'Accepter la politique de confidentialité',
                      class: "m-3"%>
          </div>
          <label class="btn btn-primary mt-4 mr-3 mb-5">
              Ajouter une photo
              <span style="display:none;">
                <%= f.input :avatar,
                            required: true,
                            input_html: { id: 'avatar-preview'},
                            label: 'Avatar'
                            %>
              </span>
            </label>
        </div>
          <div class=""  id="imagePreview">
            <img src="" alt="" class="image-preview__image wanted-avatar mt-1">
          </div>


        <div class="form-actions" id="submit">
          <%= f.button :submit, "Créer votre compte", class: 'btn btn-primary' %>
        </div>
      <% end %>

      <%= render "devise/shared/links" %>
    </div>
  </div>
</div>

<script>
  const Ifile = document.getElementById("avatar-preview")
  const previewContainer = document.getElementById("imagePreview")
  const previewImage = previewContainer.querySelector(".image-preview__image")

  const checkbox = document.getElementById("checkbox")
  Ifile.addEventListener("change", function() {
    const file = this.files[0];

    if (file) {
        const reader = new FileReader();

        previewImage.style.display = "block";

        reader.addEventListener("load", function() {
          previewImage.setAttribute("src", this.result);
        });
        reader.readAsDataURL(file);
    } else {
      previewImage.style.display = null;
    }

  });

  const check = document.getElementById("checkbox")
  check.addEventListener("change", function() {
      myFunction();
    });
    function myFunction() {
    var x = document.getElementById("submit");
    if (x.style.display === "block") {
      x.style.display = "none";
    } else {
      x.style.display = "block";
    }
  }
</script>
<style>
#submit {
  width: 100%;
  padding: 50px 0;
  text-align: center;
  background-color: lightblue;
  margin-top: 20px;
  display: none
}
</style>
