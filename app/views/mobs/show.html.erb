<div class="container">
  <%= render 'shared/dashboard' %>
  <h1 class="font-custom text-center  "> <%= @place.name %>
  </h1>
  <% if @player.health <= 0 %>
    Votre santé est à O
  <% elsif @player.in_fight_enemy == "" && @player.in_fight_mob != @mob.name %>
    <%= link_to 'Vous êtes déja en combat ici ⚔️', mob_path(Mob.find_by(name: @player.in_fight_mob)) %>
  <% elsif @player.in_fight_enemy != "" && @player.fight != "attacked" %>
    <%= link_to 'Vous êtes en combat ici ⚔️', player_pvp_path(Player.find_by(user: User.find_by(pseudo: @player.in_fight_enemy))) %>
  <% elsif @player.in_fight_enemy != "" && @player.fight == "attacked"  %>
    Vous êtes actuellement attaqué par <%= User.find_by(pseudo: @player.in_fight_enemy).pseudo %> (résultat dans 2min max)
  <% else %>
    <% if @player.health <= 0 %>
    Perdu!  Vous devez attendre de récupérer de la santé (santé maximum récupérée chaque jour)
        <%= link_to 'retour', place_path(@mob.place_id), class: "btn btn-success" %>
    <% else %>
      <div class="m-3 d-flex">
        <div class="card col-6 col-md-6 mx-2">
        <h1>Votre Puissance D'Attaque🗡️: <%= @player.player_power %></h1>
        <div class="progress">
          <div class="progress-bar" role="progressbar" style="width: 100%" aria-valuenow="15" aria-valuemin="0" aria-valuemax="100">de 0 à 20 <%= '🗡️' if @player.player_power < 21 %></div>
          <div class="progress-bar bg-success" role="progressbar" style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100">21 Parfait! <%= '🗡️' if @player.player_power == 21 %> </div>
          <div class="progress-bar bg-danger" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="90" aria-valuemax="100"> >21 Perdu</div>
        </div>
          écart de niveau: + <%= @player.level - @mob.level %> à la résolution du combat
          <br>
          <% if @player.player_power == 0 %>
           <%= button_to 'Attaquer (+1 à +11)',mob_power_path(@mob), method: :post %>
          <% elsif @player.fight == 'lose' %>
            Perdu!
            <%= button_to 'Continuer?', mob_retry_player_path(@mob), method: :post,data: { disable_with: "Continuer?" } %> ou <%= button_to 'Fuir?',mob_run_path(@mob), method: :post,data: { disable_with: "Fuir" } %>
    1 blessure
          <% elsif @player.player_power == 21%>
            Puissance Maximale!
            <%= button_to 'Résoudre', mob_resolve_path(@mob) , method: :post, data: { disable_with: "Résoudre" } %> ou <%= button_to 'Fuir?',mob_run_path(@mob), method: :post %>
          <% elsif @player.player_power < 21 %>
            <%= button_to 'Attaquer (+1 à +11)',mob_power_path(@mob), method: :post %>
            ou
            <%= button_to 'Résoudre', mob_resolve_path(@mob) , method: :post, data: { disable_with: "Résoudre" } %>
            ou <%= button_to 'Fuir?',mob_run_path(@mob), method: :post,data: { disable_with: "fuir" } %>
          <% end %>

       </div>
        <div class="card col-6 col-md-6  mx-2">
              <h1><%= @mob.name %>: Puissance D'Attaque🗡️ <%= @player.mob_power %>  </h1>
              <%= image_tag @mob.image , :class => "product-photo center mt-3" %>
               LVL:<%= @mob.level %>💪 Santé:<%= @player.mob_health %>/<%= @mob.health %>❤️ Bonus: <%= @mob.bonus %> 🍈
        </div>
      </div>
    <% end %>
  <% end %>
</div>



